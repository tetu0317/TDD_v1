# TC_004: 複数結果検索テスト

## テストケース情報

| 項目 | 内容 |
|------|------|
| **テストケースID** | TC_004 |
| **テスト分類** | 単体テスト |
| **対象クラス** | DocumentSearcher |
| **対象メソッド** | `search(keyword)` |
| **優先度** | 高 |

## テスト内容

### 事前条件（試験規格）
- 内容に"システム"を含む複数ドキュメントが登録済み

### 判定条件（試験合格値）
- 該当する全ドキュメントが配列で返却される

## テストデータ

```javascript
documents = [
  { title: "設計書.txt", path: "/documents/design.txt", content: "システム設計に関する文書です。" },
  { title: "仕様書.txt", path: "/documents/spec.txt", content: "機能仕様とシステム要件を記載。" },
  { title: "議事録.txt", path: "/documents/minutes.txt", content: "会議の内容と決定事項。" }
]
```

## 検証項目

1. `search("システム")`の結果が配列である
2. 結果の長さが2（"設計書.txt"と"仕様書.txt"）
3. 全ての結果のcontentフィールドに"システム"が含まれる

## テストコード例

```javascript
test('キーワード"システム"で検索時、該当する2件が返却される', () => {
  const searcher = new DocumentSearcher();
  searcher.addDocument('設計書.txt', '/documents/design.txt', 'システム設計に関する文書です。');
  searcher.addDocument('仕様書.txt', '/documents/spec.txt', '機能仕様とシステム要件を記載。');
  searcher.addDocument('議事録.txt', '/documents/minutes.txt', '会議の内容と決定事項。');

  const results = searcher.search('システム');

  expect(Array.isArray(results)).toBe(true);
  expect(results).toHaveLength(2);
});

test('全ての結果のcontentに"システム"が含まれる', () => {
  const searcher = new DocumentSearcher();
  searcher.addDocument('設計書.txt', '/documents/design.txt', 'システム設計に関する文書です。');
  searcher.addDocument('仕様書.txt', '/documents/spec.txt', '機能仕様とシステム要件を記載。');
  searcher.addDocument('議事録.txt', '/documents/minutes.txt', '会議の内容と決定事項。');

  const results = searcher.search('システム');

  results.forEach(doc => {
    expect(doc.content).toContain('システム');
  });
});
```

## TDD実施履歴

### 🔴 Red（失敗するテストを書く）

**実施日**: 2025-11-19

**実施内容**:
1. テストコードを作成: `test/単体テスト/DocumentSearcher/TC_004.test.js`
2. テスト実行
   ```
   FAIL test/単体テスト/DocumentSearcher/TC_004.test.js
   expect(received).toHaveLength(expected)
   Expected length: 2
   Received length: 0
   ```
3. 結果: ❌ テスト失敗（期待通り）

### 🟢 Green（テストを通す最小限の実装）

**実施日**: 2025-11-19

**実施内容**:
1. `search()`メソッドはTC_003で既に実装済み
   - 複数結果を返すロジックは既存実装で対応可能
   - 追加実装不要

2. テスト実行
   ```
   PASS test/単体テスト/DocumentSearcher/TC_004.test.js
   ✓ キーワード"システム"で検索時、該当する2件が返却される (1 ms)
   ✓ 全ての結果のcontentに"システム"が含まれる (1 ms)
   ```

3. 結果: ✅ テスト成功

### 🔵 Refactor（リファクタリング）

**実施日**: 2025-11-19

**実施内容**:
- 既存実装で十分な品質を確保
- テスト再実行で継続的に成功を確認

**最終結果**: ✅ 全テスト成功

### テスト実行サマリー

| フェーズ | 状態 | 実施日 |
|---------|------|--------|
| Red | ✅ 完了 | 2025-11-19 |
| Green | ✅ 完了 | 2025-11-19 |
| Refactor | ✅ 完了 | 2025-11-19 |

## 関連ドキュメント

- 実装ファイル: `src/DocumentSearcher.js`
- テストファイル: `test/単体テスト/DocumentSearcher/TC_004.test.js`
